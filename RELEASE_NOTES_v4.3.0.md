# 🎉 植人大树 Prompt Manager v4.3.0 发布说明

## 📦 版本信息

- **版本号**: v4.3.0
- **发布日期**: 2026-01-17
- **重大更新**: 全新随机模式系统 + 首次使用引导

---

## ✨ 核心更新

### 🎯 差异化随机模式菜单

脚本现在会根据**面板位置**自动切换随机模式菜单：

#### 文字面板（左侧）- 5个模式

- 📸 **写真模式** - 专业写真提示词生成
- 🔞 **R18写真** - 成人写真双库组合
- 🎲 **三连抽取** - 快速随机3条
- 🎨 **多类混合** - 跨分类混搭
- 🌀 **混沌生成** - 完全随机生成

#### 视频面板（右侧）- 2个精简模式

- 🎬 **视频随机** - 精准单条视频提示词
- 🔞 **R18视频** - 双库组合视频生成

### 🎓 全模式首次使用引导

所有7个随机模式都配备了**首次使用引导弹窗**：

- ✅ 清晰的功能说明
- ✅ 3步操作指南
- ✅ 实例展示
- ✅ 专属主题配色
- ✅ 永久记忆（只显示一次）

---

## 🚀 新功能详解

### 📸 写真模式

**功能**：一键生成专业写真提示词

**工作原理**：

1. 从"写真模式标准描述"库随机抽取**1条**（标准开头）
2. 从所有文字库中随机抽取**10条**（风格元素）
3. 自动组合：`标准开头, 随机1, 随机2, ..., 随机10`

**所需库**：

- 库名：`写真模式标准描述`
- 类型：文字库（在左侧面板创建）
- 示例内容：

  ```
  真实胶片直闪摄影，亚洲女性，小红书网红脸，表情冷漠而自信，姿态略带挑逗，身材真实吸引人
  ```

### 🔞 R18写真

**功能**：成人写真双重定位生成

**工作原理**：

1. 从"写真模式标准描述"库抽**1条**
2. 从"成人模式标准添加词"库抽**1条**
3. 从所有文字库随机抽**10条**
4. 组合：`标准开头, 成人修饰, 随机1, ..., 随机10`

**所需库**：

- 库1：`写真模式标准描述`
- 库2：`成人模式标准添加词`
- 类型：都是文字库
- 示例内容：

  ```
  姿态略带挑逗，身材真实吸引人，性感撩人，暴露度适中
  ```

### 🎬 视频随机

**功能**：精简视频提示词生成（避免混淆AI）

**工作原理**：

- 从"视频提示词"库随机抽取**仅1条**

**所需库**：

- 库名：`视频提示词`
- 类型：视频库（**在右侧面板创建**）
- 示例内容：

  ```
  Fabric: 细致黑色蕾丝边缘动作微微晃动，露出圆润头
  Legs: 双膝缓慢弯曲并下蹲，腿部肌肉线条轻微绷紧
  Atmosphere: 浓密蒸汽汽中身体轻摇摆出现，玻璃反射出阴影
  ```

### 🔞 R18视频

**功能**：视频成人内容双库组合

**工作原理**：

1. 从"视频提示词"库抽**1条**
2. 从"R18视频添加提示词"库抽**1条**
3. 组合：`视频提示词, R18修饰`

**所需库**：

- 库1：`视频提示词`
- 库2：`R18视频添加提示词`
- 类型：都是视频库（**在右侧面板创建**）
- 示例内容：

  ```
  Pose: 身体侧躺并前倾下，腰线收紧呈弧线展开，布料微掀
  ```

---

## 📋 完整使用指南

### 第一步：创建必需的库

#### 文字模式专用库

1. **切换到左侧文字面板**
2. **创建"写真模式标准描述"**：
   - 点击"创建库"
   - 输入库名：`写真模式标准描述`
   - 添加多条标准写真开头
3. **创建"成人模式标准添加词"**（如需R18）：
   - 再次点击"创建库"
   - 输入库名：`成人模式标准添加词`
   - 添加成人修饰词

#### 视频模式专用库

1. **切换到右侧视频面板**
2. **创建"视频提示词"**：
   - 点击"创建库"
   - 输入库名：`视频提示词`
   - 添加视频动作/氛围描述
3. **创建"R18视频添加提示词"**（如需R18）：
   - 再次点击"创建库"
   - 输入库名：`R18视频添加提示词`
   - 添加R18视频修饰

### 第二步：使用随机模式

1. 点击面板右上角的 **🎲 骰子按钮**
2. 从弹出菜单中选择模式
3. **首次使用**会显示引导弹窗
4. 点击"知道了，开始使用"
5. 提示词自动填入输入框

### 第三步：调整优化

- **不满意？** 再次点击同一模式，重新随机
- **想换模式？** 选择其他随机模式
- **手动调整？** 直接在输入框中编辑生成的提示词

---

## ⚠️ 重要提示

### 库类型自动识别

- ✅ **左侧面板**导入/创建 → 自动标记为 `libraryType: 'text'`
- ✅ **右侧面板**导入/创建 → 自动标记为 `libraryType: 'video'`
- ❌ 不要在错误的面板创建库！

### 库名精确匹配

专用库名必须**精确匹配**或**包含关键词**：

- `写真模式标准描述` 或包含"写真模式"
- `成人模式标准添加词` 或包含"成人模式"
- `视频提示词` 或包含"视频提示词"
- `R18视频添加提示词` 或包含"R18视频"

### 视频模式精简原则

视频模式**只抽取1-2条**提示词：

- ✅ 避免提示词过多混淆AI
- ✅ 确保视频生成质量
- ✅ 每条提示词应独立完整

---

## 🎨 视觉设计

### 主题配色

每个模式都有专属主题色：

| 模式 | 颜色 | 色值 |
|------|------|------|
| 📸 写真模式 | Tiffany蓝 | `#1d9bf0` |
| 🔞 R18写真 | 粉红色 | `#e91e63` |
| 🎲 三连抽取 | 紫色 | `#9c27b0` |
| 🎨 多类混合 | 橙色 | `#ff9800` |
| 🌀 混沌生成 | 深紫色 | `#673ab7` |
| 🎬 视频随机 | 深紫色 | `#673ab7` |
| 🔞 R18视频 | 粉红色 | `#e91e63` |

### Toast通知

每次生成后会显示Toast提示：

- 显示位置：屏幕顶部居中
- 自动消失：3秒
- 包含信息：模式名 + 生成统计

---

## 🔧 故障排查

### 问题1：提示"未找到XXX库"

**原因**：库名不匹配或库为空

**解决**：

1. 检查库名是否完全正确
2. 确认库中至少有1条提示词
3. 确认在正确的面板创建（文字/视频）

### 问题2：视频模式抽到文字库内容

**原因**：库类型标记错误

**解决**：

1. 删除该库
2. 切换到**右侧视频面板**
3. 重新创建/导入库

### 问题3：首次引导不显示

**原因**：localStorage已记录

**解决**：

```javascript
// 在浏览器控制台执行
localStorage.removeItem('gpm_portrait_guide_seen');
localStorage.removeItem('gpm_r18_guide_seen');
localStorage.removeItem('gpm_video_random_guide_seen');
localStorage.removeItem('gpm_video_r18_guide_seen');
localStorage.removeItem('gpm_random3_guide_seen');
localStorage.removeItem('gpm_catmix_guide_seen');
localStorage.removeItem('gpm_chaos_guide_seen');
```

---

## 📊 版本历史

### v4.3.0 (2026-01-17)

- ✨ 新增：视频随机和R18视频的首次使用引导
- 🎨 优化：所有7个模式配色统一

### v4.2.0 (2026-01-17)

- ✨ 新增：视频面板专用随机模式（2个精简模式）
- 🎯 优化：面板差异化菜单（文字5个，视频2个）

### v4.1.0 (2026-01-17)

- ✨ 新增：三连抽取、多类混合、混沌生成的首次使用引导

### v4.0.0 (2026-01-17)

- ✨ 新增：R18写真模式及首次使用引导
- 🎨 重构：所有模式命名（去除英文）

### v3.8.0 (2026-01-17)

- ✨ 新增：写真模式首次使用引导

### v3.7.0 (2026-01-17)

- ✨ 新增：写真模式（全自动）

---

## 💡 最佳实践

1. **库的组织**：
   - 文字库：按风格/分类组织（人物、场景、氛围等）
   - 视频库：每条提示词独立完整，描述单一动作或效果

2. **专用库管理**：
   - 定期更新"写真模式标准描述"库，测试不同开头效果
   - "成人模式标准添加词"库保持精简，每条都是经过验证的修饰

3. **视频提示词编写**：
   - 格式：`类别: 详细描述`
   - 示例：`Fabric: 细致黑色蕾丝边缘动作微微晃动`
   - 每条长度适中，避免过长或过短

4. **测试流程**：
   - 首次使用每个模式，阅读引导说明
   - 多次点击同一模式，测试随机效果
   - 根据生成质量调整库内容

---

## 📞 支持

如有问题或建议，请通过以下方式联系：

- GitHub Issues
- 用户反馈群

---

**祝你使用愉快！🎊**
